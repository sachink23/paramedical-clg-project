function onAffLoad(){
    //$("#info_admission").modal("show");
    $('#info_affiliation').modal({backdrop: 'static', keyboard: false})
  }
  if(window.addEventListener) {
      window.addEventListener('load',onAffLoad,false); //W3C
  } else {
      window.attachEvent('onload',onAffLoad);   //IE
  }
  class affiliation {
      data = new FormData();
      submit() {
        this.data = new FormData();
        try {
            if(!this.verify()) {
                this.data = new FormData();
                return false;
            }
        } catch {
            return false;
        }
          return true;
      }
      verify() {
        this.data = new FormData();
        var ins = document.getElementById("nameOfIns");
        if(ins.value.length < 4 || ins.value.length > 200) {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेचे नाव तपासा"
            }) 
            return false;
        }
        this.data.append("name", ins.value);
        var pres = document.getElementById("nameOfPres");
        if(pres.value.length < 4 || pres.value.length > 200) {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेच्या अध्यक्ष्यांचे नाव तपासा"
            }) 
            return false;
        }
        this.data.append("name_of_pres", pres.value);
        var regNo = document.getElementById("regNo");
        if(regNo.value.length < 4 || regNo.value.length > 100) {
            swal.fire({
                type: "error",
                title: "कृपया संस्था नोंदणी क्रमांक तपासा"
            }) 
            return false;
        }
        this.data.append("reg_no", regNo.value);
        var regDate = document.getElementById("regDate");
        if(regDate.value.length != 10) {
            swal.fire({
                type: "error",
                title: "कृपया नोंदणीची तारीख तपासा"
            })
            return false;
        }
        this.data.append("reg_date", regDate.value);
        var mob1 = document.getElementById("mob1");
        if(mob1.value < 10000000 || mob1.value > 999999999999999) {
            swal.fire({
                type: "error",
                title: "कृपया दूरध्वनी क्रमांक 1 तपासा"
            })
            return false;
        }
        this.data.append("mob1", mob1.value);
        var mob2 = document.getElementById("mob2");
        if(mob2.value < 10000000 || mob2.value > 999999999999999) {
            swal.fire({
                type: "error",
                title: "कृपया दूरध्वनी क्रमांक 2 तपासा"
            })
            return false;
        }
        this.data.append("mob2", mob2.value);
        var email = document.getElementById("email");
        var x = email.value;  
        var atposition=x.indexOf("@");  
        var dotposition=x.lastIndexOf(".");  
        if (atposition<1 || dotposition<atposition+2 || dotposition+2>=x.length){
            swal.fire({
                type: "error",
                title: "कृपया ईमेल आयडी तपासा"
            })
            return false;
        }  
        this.data.append("email", email.value);
        var website = document.getElementById("website");
        if(website.value == null) {
            website.value = "NA";
        }
        this.data.append("website", website.value);
        var address = document.getElementById("address");
        if(address.value.length < 4 || address.value.length > 200) {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेचा पूर्ण पत्ता तपासा"
            }) 
            return false;
        }
        this.data.append("address", address.value);
        if(document.getElementById("locationInfo").checked == true) {
            var buildingType = 1;
        } else if(document.getElementById("locationInfo1").checked == true) {
            var buildingType = 0;
        } else {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेच्या इमारतीचा प्रकार निवडा"
            }) 
            return false;
        }
        this.data.append("building_type", buildingType);
        if(document.getElementById("employeeType").checked == true) {
            var employeeType = 1;
        } else if(document.getElementById("employeeType1").checked == true) {
            var employeeType = 0;
        } else {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेच्या कर्मचाऱ्यांच्या प्रकार निवडा",
                text: "जसे कि नियमित आहेत / कंत्राटी आहेत"
            
            }) 
            return false;
        }
        this.data.append("employee_type", employeeType);
        var nosOfemp = document.getElementById("nosOfEmployees");
        if(nosOfemp.value < 1 || nosOfemp.value > 1000) {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेकडे उपलब्ध कर्मचारी संख्या तपासा"
            
            }) 
            return false;
        }
        this.data.append("nos_of_emp", nosOfemp.value);
        if(document.getElementById("areCompsAvlbl").checked == true) {
            var compAvlbl = 1;
        } else if(document.getElementById("areCompsAvlbl1").checked == true) {
            var compAvlbl = 0;
        } else {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेकडे संगणक आणि इंटरनेट सुविधा आहे / नाही निवडा",
            }) 
            return false;
        }
        this.data.append("are_comps_avlbl", compAvlbl);
        var nosOfBook = document.getElementById("nosOfBooks");
        if(document.getElementById("isLibraryAvlbl").checked == true) {
            var libAvlbl = 1;
            if(nosOfBook.value < 1 && nosOfBook.value > 99999999999999) {
                swal.fire({
                    type: "error",
                    title: "कृपया संस्थेकडे एकूण किती पुस्तके उपलब्ध आहेत ते भरा",
                }) 
                return false;
            }
        } else if(document.getElementById("isLibraryAvlbl1").checked == true) {
            var libAvlbl = 0;
            nosOfBook.value = 0;
        } else {
            swal.fire({
                type: "error",
                title: "कृपया संस्थेकडे वाचनालय सुविधा आहे / नाही निवडा",
            }) 
            return false;
        }
        this.data.append("is_library_available", libAvlbl);
        this.data.append("no_of_books", nosOfBook.value);
        var otherAct = document.getElementById("otherActivities");
        if(otherAct.value == null) {
            otherAct.value = "NA";
        }
        this.data.append("other_act", otherAct.value); 
        var sal1 = document.getElementById("salutation1");
        if(!(sal1.value == 0 || sal1.value == 1)) {
            swal.fire({
                type: "error",
                title: "संस्था पदाधिकाऱ्यांची माहिती तपासा",
                text: "तुम्ही संस्था पदाधिकाऱ्यांचे नाव / संबोधन विसरला आहात"
            })
            return false;
        }
        this.data.append("sal_1", sal1.value);
        var name1 = document.getElementById("name1");
        if(name1.value.length < 3 && name1.value.length > 100 && name2.value.length < 3 && name2.value.length > 100) {
            swal.fire({
                type: "error",
                title: "संस्था पदाधिकाऱ्यांची माहिती तपासा",
                text: "तुम्ही संस्था पदाधिकाऱ्यांचे नाव / संबोधन विसरला आहात"
            })
            return false;
        }
        this.data.append("name_1", name.value);
        var name2 = document.getElementById("name2");
        var sal2 = document.getElementById("salutation2");
        if(!(sal2.value == 0 || sal2.value == 1)) {
            swal.fire({
                type: "error",
                title: "संस्था पदाधिकाऱ्यांची माहिती तपासा",
                text: "तुम्ही संस्था पदाधिकाऱ्यांचे नाव / संबोधन विसरला आहात"
            })
            return false;
        }
        this.data.append("sal_2", sal2.value);
        this.data.append("name_1", name2.value);

        if(document.getElementById("regedCertY").checked == true) {
            this.data.append("reged_cert_attached", 1);
        } else if(document.getElementById("regedCertN").checked == true) {
            this.data.append("reged_cert_attached", 0)
        } else {
            swal.fire({
                type: "error",
                title: "संस्थेने सलंग्नता अर्ज सादर करताना कागदपत्रांच्या छायांकित प्रती जोडणे आवश्यक आहे. जी कागदपत्रे जोडली आहेत त्यासमोरील आहे / नाही वर क्लीक / टच करा."
            })
            return false;
        }

        if(document.getElementById("panY").checked == true) {
            this.data.append("pan_attached", 1);
        } else if(document.getElementById("panN").checked == true) {
            this.data.append("pan_attached", 0)
        } else {
            swal.fire({
                type: "error",
                title: "संस्थेने सलंग्नता अर्ज सादर करताना कागदपत्रांच्या छायांकित प्रती जोडणे आवश्यक आहे. जी कागदपत्रे जोडली आहेत त्यासमोरील आहे / नाही वर क्लीक / टच करा."
            })
            return false;
        }

        if(document.getElementById("OpanY").checked == true) {
            this.data.append("Opan_attached", 1);
        } else if(document.getElementById("OpanN").checked == true) {
            this.data.append("Opan_attached", 0)
        } else {
            swal.fire({
                type: "error",
                title: "संस्थेने सलंग्नता अर्ज सादर करताना कागदपत्रांच्या छायांकित प्रती जोडणे आवश्यक आहे. जी कागदपत्रे जोडली आहेत त्यासमोरील आहे / नाही वर क्लीक / टच करा."
            })
            return false;
        }

        if(document.getElementById("buildingProofY").checked == true) {
            this.data.append("building_proof_attached", 1);
        } else if(document.getElementById("buildingProofN").checked == true) {
            this.data.append("building_proof_attached", 0)
        } else {
            swal.fire({
                type: "error",
                title: "संस्थेने सलंग्नता अर्ज सादर करताना कागदपत्रांच्या छायांकित प्रती जोडणे आवश्यक आहे. जी कागदपत्रे जोडली आहेत त्यासमोरील आहे / नाही वर क्लीक / टच करा."
            })
            return false;
        }

        if(document.getElementById("electY").checked == true) {
            this.data.append("elect_attached", 1);
        } else if(document.getElementById("electN").checked == true) {
            this.data.append("elect_attached", 0)
        } else {
            swal.fire({
                type: "error",
                title: "संस्थेने सलंग्नता अर्ज सादर करताना कागदपत्रांच्या छायांकित प्रती जोडणे आवश्यक आहे. जी कागदपत्रे जोडली आहेत त्यासमोरील आहे / नाही वर क्लीक / टच करा."
            })
            return false;
        }       
        if(document.getElementById("reportY").checked == true) {
            this.data.append("report_attached", 1);
        } else if(document.getElementById("reportN").checked == true) {
            this.data.append("report_attached", 0)
        } else {
            swal.fire({
                type: "error",
                title: "संस्थेने सलंग्नता अर्ज सादर करताना कागदपत्रांच्या छायांकित प्रती जोडणे आवश्यक आहे. जी कागदपत्रे जोडली आहेत त्यासमोरील आहे / नाही वर क्लीक / टच करा."
            })
            return false;
        } 
        if(document.getElementById("tosCheck").checked == true) {
            this.data.append("iAgree", 1);
        } else {
            this.data.append("iAgree", 0);
            swal.fire({
                type:"error", 
                title: "Please check terms and conditions..."
            })
            return false;
        }
        this.data.append("request", "newAffiliationForm");


        return true;
    }
    
  }
  var aff = new affiliation;
  function listenAff(status, res) {
    try {
      var res = JSON.parse(res);
    } catch {
        swal.fire({
            title: "Server Error",
            text: "It seems like server was unable to process your request, try submitting form again. Please contact administrator if error persists.",
            type: "error"
        });
      return false;
    }
   /* try {
        eval(res.func);
      }
      catch {
        void(0);
    }*/
    if (status == 200) {
      if (res.code == 200) {
          swal.fire({
              type: "success",
              title: res.message,
              html: res.text
          })
          return true;
      } else if (res.code == 201) {
          swal.fire({
              type: "error",
              title: res.message,
              text: res.text
          })
          return false;
      } else if(res.code == 400) {
        swal.fire({
            type: "error",
            title: res.message,
            text: "Please check if you have filled the form properly, if still getting the error try using latest browser"
        })
        return false;
      } else {
        swal.fire({
            title: "Server Error",
            text: "It seems like server was unable to process your request, try submitting form again. Please contact administrator if error persists.",
            type: "error"
        });
        return false;
      }
    } else if (status == 0) {
        swal.fire({
            title: "Internet Not Connected",
            type: "warning",
            text: "It seems like your device is having some connection issues while connecting to our servers, please check if you are connected to the internet."
        });
        return false;
        
    } else {
        swal.fire({
            title: "Server Error",
            text: "It seems like server was unable to process your request, try submitting form again. Please contact administrator if error persists.",
            type: "error"
        });
        return false;
    }

  }
  function submitAffiliationForm() {
      var http = new xhr;
    if(aff.submit()) {
        http.post("/api/affiliation/new/", aff.data, listenAff);
        
        return true;
    }
    
  }